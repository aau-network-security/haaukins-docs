<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.f7e014c26dc6a3f2f527ee8c78e0f848f3426738a3acffa4f2bf800d63d942d0595a0a1b4a9182f453aa2e546be04edf0222cb3983df4816b0c4ddf999aa9345.css integrity="sha512-9&#43;AUwm3Go/L1J&#43;6MeOD4SPNCZzijrP&#43;k8r&#43;ADWPZQtBZWgobSpGC9FOqLlRr4E7fAiLLOYPfSBawxN35maqTRQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Binary - Haaukins</title><meta name=description content="Binary challenges for Haaukins Platform"><link rel=canonical href=/docs/challenges/binary/><meta name=twitter:card content=summary_large_image><meta name=twitter:image content=/doks.png><meta name=twitter:title content=Binary><meta name=twitter:description content="Binary challenges for Haaukins Platform"><meta name=twitter:site content=@henkverlinde><meta name=twitter:creator content=@henkverlinde><meta property=og:title content=Binary><meta property=og:description content="Binary challenges for Haaukins Platform"><meta property=og:type content=article><meta property=og:url content=/docs/challenges/binary/><meta property=og:image content=/doks.png><meta property=article:published_time content=2020-10-13T15:21:01+02:00><meta property=article:modified_time content=2021-02-28T21:16:01+02:00><meta property=og:site_name content=Haaukins><meta property=article:publisher content=https://www.facebook.com/verlinde.henk><meta property=article:author content=https://www.facebook.com/verlinde.henk><meta property=og:locale content=en_US><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/"},{"@type":"ListItem","position":2,"name":"Docschallengesbinary","item":"\/docschallengesbinary\/"}]}</script><meta name=theme-color content=#fff><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=/>Haaukins</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><path d="M12 1V3z"/><path d="M12 21v2z"/><path d="M4.22 4.22 5.64 5.64z"/><path d="M18.36 18.36 19.78 19.78z"/><path d="M1 12H3z"/><path d="M21 12h2z"/><path d="M4.22 19.78 5.64 18.36z"/><path d="M18.36 5.64 19.78 4.22z"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/aau-network-security/haaukins><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0 0 20 4.77 5.07 5.07.0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38.0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 0 0 5 4.77a5.44 5.44.0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 0 0 9 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=/docs/haaukins/introduction/>Docs</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Haaukins</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/haaukins/configuration/>Configuration</a></li><li><a class=docs-link href=/docs/haaukins/connected-services/>Connected Services</a></li><li><a class=docs-link href=/docs/haaukins/installation/>Installation</a></li><li><a class=docs-link href=/docs/haaukins/introduction/>Introduction</a></li><li><a class=docs-link href=/docs/haaukins/testing/>Testing</a></li></ul><h3>Challenges</h3><ul class=list-unstyled><li><a class="docs-link active" href=/docs/challenges/binary/>Binary</a></li><li><a class=docs-link href=/docs/challenges/cryptography/>Cryptography</a></li><li><a class=docs-link href=/docs/challenges/forensics/>Forensics</a></li><li><a class=docs-link href=/docs/challenges/reverse-engineering/>Reverse Engineering</a></li><li><a class=docs-link href=/docs/challenges/starters/>Starters</a></li><li><a class=docs-link href=/docs/challenges/web-exploitation/>Web Exploitation</a></li><li><a class=docs-link href=/docs/challenges/challenge-struct/>A Challenge Struct</a></li><li><a class=docs-link href=/docs/challenges/how-to-create-chal/>How to Create A Challenge</a></li></ul><h3>Help</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/help/troubleshooting/>Troubleshooting Haaukins</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#binary>Binary</a><ul><li><ul><li><a href=#difficulty-levels>Difficulty Levels</a></li></ul></li><li><a href=#bittit-account-recovery>Bittit Account Recovery</a></li><li><a href=#set-user-id>Set User ID</a></li><li><a href=#format-string-exploitation>Format String Exploitation</a></li><li><a href=#corroption-please>CorROPtion, please!</a></li><li><a href=#shrunk-chunk-heap-overflow>Shrunk-Chunk Heap Overflow</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Binary</h1><p class=lead>Binary challenges for Haaukins Platform.</p><ul><li><a href=#binary>Binary</a><ul><li><a href=#difficulty-levels>Difficulty Levels</a></li><li><a href=#bittit-account-recovery>Bittit Account Recovery</a></li><li><a href=#set-user-id>Set User ID</a></li><li><a href=#format-string-exploitation>Format String Exploitation</a></li><li><a href=#corroption-please>CorROPtion, please!</a></li><li><a href=#shrunk-chunk-heap-overflow>Shrunk-Chunk Heap Overflow</a></li></ul></li></ul><h1 id=binary>Binary</h1><p>Binary exploitation is the process of subverting a compiled application such that it violates some trust boundary in a way that is advantageous to the attacker. It comes down by abusing vulnerabilities that corrupt memory in software or by finding a vulnerability in the program and exploiting it in order to escalate privileges.</p><h3 id=difficulty-levels>Difficulty Levels<a href=#difficulty-levels class=anchor aria-hidden=true>#</a></h3><p>The levels of difficulty scale is based on the number of steps required in order to solve the
Training Challenge</p><ul><li><strong>Very Easy​:</strong> It requires just one step in order to get the flag</li><li><strong>Easy:</strong>​ It requires one-two steps, it is based on the challenge category</li><li><strong>Medium​:</strong> It requires two-three steps, it is based on the challenge category</li><li><strong>Hard:</strong> ​It requires three-four steps based on the challenge category</li><li><strong>Very Hard:</strong>​ It requires several steps in order to get the flag</li></ul><h2 id=bittit-account-recovery>Bittit Account Recovery<a href=#bittit-account-recovery class=anchor aria-hidden=true>#</a></h2><p><strong>Points</strong>: 27 <strong>Difficulty</strong>: Easy</p><p><strong>Learning Objectives:</strong><br>- Improvement of binary exploitation skills, such as overflowing the stack.
- Getting more comfortable with Assembly code and tools like GDB and objdump.</p><p><strong>Description:</strong><br>This challenge requires that the user bypasses a nonpermissive program flow in a binary containing an encrypted username and password. A pretend online forum has implemented an &lsquo;alternative&rsquo; account recovery policy. The user downloads the binary from the website, and can then obtain the username and password through binary exploitation. Logging in with these credentials prints the flag.</p><p><strong>Prerequisite:</strong><br>- Knowledge about the x86-64 instruction set.
- Knowledge about GDB or a similar tool.
- Knowledge about how the stack can be overwritten by exploiting functions like <code>gets()</code>.</p><h2 id=set-user-id>Set User ID<a href=#set-user-id class=anchor aria-hidden=true>#</a></h2><p><strong>Points:</strong> ​ 30 <strong>Difficulty:</strong> ​Easy</p><p><strong>Learning Objectives:</strong>
- Learn how to escalate the privilege and get root access
- ​Scanning a system to check if programs have specific privileges</p><p><strong>Description:</strong> ​In this challenge the users will have access to an SSH session in which there
are a file containing the flag. That file is only readable by user with root privileges. In order to
solve the challenge the user will have to find the command for which is set the SUID bit and
then escalate privileges in order to open the file containing the flag.</p><p><strong>Prerequisite:</strong>
- Basic usage of Linux from command line
- Know Linux user permissions</p><h2 id=format-string-exploitation>Format String Exploitation<a href=#format-string-exploitation class=anchor aria-hidden=true>#</a></h2><p><strong>Points:</strong> ​ 35 <strong>Difficulty:</strong> ​Medium</p><p><strong>Learning Objectives:</strong>
- Learn how to read data from the stack using format strings while avoiding memory access violations.</p><p><strong>Description:</strong> This challenge is about utilizing a simple format string exploit. A program named FormatString plays a game with the user, who has to guess the password, while the program repeats the user&rsquo;s guesses, using printf() on the input string. As it turns out, printf(), along with similar functions, has the quirk that it will carelessly read data off the stack when it looks for arguments corresponding to format specifiers in its control string - even when no arguments are specified, e.g.:</p><pre><code>printf(&quot;%s %x %d %c&quot;);
</code></pre><p>Providing input with the right format specifiers will make the program slip up and reveal the password, hiding somewhere on the stack, on its own accord. Entering the password will make the program print the flag.</p><p><strong>Prerequisite:</strong>
- Knowledge of where and how functions in the printf() school of thought look for their arguments.
- Basic knowledge of how the stack and its frames are organized.
- Basic knowledge of memory access through pointers and when they are legal/illegal (e.g. Segmentation faults).</p><h2 id=corroption-please>CorROPtion, please!<a href=#corroption-please class=anchor aria-hidden=true>#</a></h2><p><strong>Points:</strong> 60 <strong>Difficulty:</strong> Hard</p><p><strong>Learning Objectives:</strong><br>- Learn how to do memory corruption with ROP when the stack is not executable.
- Get more hands-on tinkering experience with x86-64, binary files/tools etc.</p><p><strong>Description:</strong><br>In this challenge, the user is given a binary file with a buffer overflow vulnerability on the stack. A function must be called with specific parameters in order to print the flag. The stack is non-executable, but ROP can be used to orchestrate the call, by &ldquo;borrowing&rdquo; data and code snippets lying around in the binary.</p><p><strong>Prerequisite:</strong><br>- Knowledge about the possibility of corrupting stack memory, when <code>gets()</code> from the C Standard Library fetches user input.
- Knowledge about how different file hardening techniques like stack-executability, canaries and PIE make exploits possible/&ldquo;impossible&rdquo;.
- Knowledge about the broad-strokes layout of binary files, e.g. where hard-coded data is stored.
- Knowledge about the role of the stack and how stack memory is managed.
- Working knowledge about the x86-64 instruction set, corresponding to an undergraduate course.
- Comfortable with using the GDB and binutils in the terminal to solve a challenge.
- Knowledge about Python and Bash is useful for delivering the payload.</p><h2 id=shrunk-chunk-heap-overflow>Shrunk-Chunk Heap Overflow<a href=#shrunk-chunk-heap-overflow class=anchor aria-hidden=true>#</a></h2><p><strong>Points:</strong> ​ 70 <strong>Difficulty:</strong> ​hard</p><p><strong>Learning Objectives:</strong>
- Knowledge of how metadata on the heap itself is used for its memory management, and how it can be exploited.
- Knowledge of how certain sequences of (de)allocations on the heap can produce overlapping chunks in previous glibc versions.
- Knowledge of how the difference between stack and heap memory management provides different approaches for buffer overflow attacks.
- Proficiency in examining the state of the heap and its allocations during runtime.
- Better understanding of how <code>malloc</code>, <code>free</code> and similar functions work.</p><p><strong>Description:</strong>
This challenge is based on an overflow vulnerability in glibc popularized in a paper named &lsquo;Glibc Adventures: The Forgotten Chunks&rsquo;. It has only been patched in relatively recent releases compared to other heap exploits. In essence, an overflow of a single null byte corrupting heap metadata and a specific sequence of malloc/free calls leads to two chunks on the heap overlapping. This is possible due to an absence of security checks in dynamic memory management. Since there are two overlapping allocations, exploiters might have indirect control over the memory area that the heap manager has &ldquo;forgotten about&rdquo; through another area. This opens up a lot of possibilities for memory writes and redirection of program execution.
In this challenge users will be presented with a binary (source code available) with a seemingly harmless &ldquo;off-by-one&rdquo; error causing the above vulnerability. By causing heap overflow with a single null byte the users can overwrite a global function pointer, redirecting program execution to call print_flag(). The program itself is fairly contrived and artificial in the way that it works, but this was chosen in order to provide a better signal-to noise-ratio for the users: Tracking several malloc/free calls will be important for solving the challenge. It runs inside a Debian 8.11 image utilizing a vulnerable glibc 2.19 implementation, and all default protection measures are in place.</p><p><strong>Prerequisite:</strong>
- Knowledge of the C programming language and commonly used functions in its standard library - namely <code>strlen</code>, <code>strcpy</code>, <code>malloc</code> and <code>free</code>.
- Knowledge of the existence of metadata on the heap itself in order to perform dynamic memory management.
- Knowledge of the ELF format and the exploitability of the .got.plt table to redirect program execution.
- Ability to use tools such as GDB, objdump and ltrace to examine binary files and runtime memory state.
- Ability to use Bash or Python in order to provide long/hexadecimal input to the program.</p><p class=edit-page><a href=https://github.com/aau-network-security/haaukins-docs/blob/master/content/docs/challenges/binary.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class="docs-navigation d-flex justify-content-between"><a href=/docs/haaukins/configuration/><div class="card my-1"><div class="card-body py-2">&larr; Configuration</div></div></a><a class=ml-auto href=/docs/help/troubleshooting/><div class="card my-1"><div class="card-body py-2">Troubleshooting Haaukins &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Haaukins - Open Source Cyber Training Platform</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline><li class=list-inline-item><a href=/privacy-policy/>Privacy</a></li></ul></div></div></div></footer><script src=/main.f6b484f556ad1f3bcf6061082139a2f21fa759f13930c39a25fe4a9f78f35e64122c2d86dffd56e67b292dabbda4095d8077194f196e0e348441c106a9f3d40e.js integrity="sha512-9rSE9VatHzvPYGEIITmi8h&#43;nWfE5MMOaJf5Kn3jzXmQSLC2G3/1W5nspLau9pAldgHcZTxluDjSEQcEGqfPUDg==" crossorigin=anonymous defer></script><script src=/index.min.7c845397b74baa3ecf80ecb6c13e584a48e52e781cc36a139c7d82c5ed5a845843638c819e0e78723ed9df9aba5eb71365dafa8109218ada765c23ec67687e72.js integrity="sha512-fIRTl7dLqj7PgOy2wT5YSkjlLngcw2oTnH2Cxe1ahFhDY4yBng54cj7Z35q6XrcTZdr6gQkhitp2XCPsZ2h&#43;cg==" crossorigin=anonymous defer></script></body></html>