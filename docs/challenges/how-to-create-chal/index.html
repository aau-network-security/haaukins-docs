<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.3efc558be62120d4f3f61531d2819409416e06dc071c2c5c79a90c7ce37102bec4c7882d4eedad8df0d96a42b8cf9a6a5482e61a232f3ac0e923b19e0d1e7354.css integrity="sha512-PvxVi+YhINTz9hUx0oGUCUFuBtwHHCxceakMfONxAr7Ex4gtTu2tjfDZakK4z5pqVILmGiMvOsDpI7GeDR5zVA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>How to Create A Challenge - Haaukins</title><meta name=description content="Creation of an challenge for Haaukins Platform described here."><link rel=canonical href=/docs/challenges/how-to-create-chal/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/doks.png"><meta name=twitter:title content="How to Create A Challenge"><meta name=twitter:description content="Creation of an challenge for Haaukins Platform described here."><meta name=twitter:site content="@henkverlinde"><meta name=twitter:creator content="@henkverlinde"><meta property="og:title" content="How to Create A Challenge"><meta property="og:description" content="Creation of an challenge for Haaukins Platform described here."><meta property="og:type" content="article"><meta property="og:url" content="/docs/challenges/how-to-create-chal/"><meta property="og:image" content="/doks.png"><meta property="article:published_time" content="2020-11-12T13:26:54+01:00"><meta property="article:modified_time" content="2021-02-28T21:16:01+02:00"><meta property="og:site_name" content="Haaukins"><meta property="article:publisher" content="https://www.facebook.com/verlinde.henk"><meta property="article:author" content="https://www.facebook.com/verlinde.henk"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/"},{"@type":"ListItem","position":2,"name":"Docschallengeshow to Create Chal","item":"\/docschallengeshow-to-create-chal\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=text/javascript>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","5v4f3jlry6")</script></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=/>Haaukins</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/aau-network-security/haaukins><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=/docs/haaukins/introduction/>Docs</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Haaukins</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/haaukins/configuration/>Configuration</a></li><li><a class=docs-link href=/docs/haaukins/connected-services/>Connected Services</a></li><li><a class=docs-link href=/docs/haaukins/installation/>Installation</a></li><li><a class=docs-link href=/docs/haaukins/introduction/>Introduction</a></li><li><a class=docs-link href=/docs/haaukins/testing/>Testing</a></li></ul><h3>Challenges</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/challenges/binary/>Binary</a></li><li><a class=docs-link href=/docs/challenges/cryptography/>Cryptography</a></li><li><a class=docs-link href=/docs/challenges/forensics/>Forensics</a></li><li><a class=docs-link href=/docs/challenges/reverse-engineering/>Reverse Engineering</a></li><li><a class=docs-link href=/docs/challenges/starters/>Starters</a></li><li><a class=docs-link href=/docs/challenges/web-exploitation/>Web Exploitation</a></li><li><a class=docs-link href=/docs/challenges/challenge-struct/>A Challenge Struct</a></li><li><a class="docs-link active" href=/docs/challenges/how-to-create-chal/>How to Create A Challenge</a></li></ul><h3>Help</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/help/troubleshooting/>Troubleshooting Haaukins</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#technical-side-of-creating-challenge>Technical side of creating challenge</a></li><li><a href=#deploying-a-challenge>Deploying a Challenge</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>How to Create A Challenge</h1><p class=lead>Creation of an challenge for Haaukins Platform described here.</p><h1 id=creating-a-challenge>Creating a Challenge</h1><p>A challenge is created as a subfolder in its category folder. A sample challenge folder is <code>sample/piece_of_pie/</code> with the contents below:</p><pre><code>example/challenge_1/
|-- README.md
|-- Dockerfile
|-- .gitlab-ci.yml
|-- tests
    `-- test_exploit.py
|-- sol/
|   `-- exploit.py
|-- config (or src) /
     |-- auto.conf
     |-- init.sh
</code></pre><p>As above, the challenge folder must have:</p><ul><li><p>The challenge folder should contain following information and main <code>README.md</code> file. You can follow <a href=../challenge-structure/>Challenge Repository Structure</a> for an example of how the readme file should be setup for your challenge;</p></li><li><p>a <code>config (or src)/</code> subfolder used for setting up environment for the challenge. This includes startup scripts and challenge source code (C, C#, python or whatever you chose).</p></li><li><p>a <code>sol (or exploit)/</code> subfolder containing the solution/exploit script. Only if applicable to your challenge</p></li><li><p>a <code>tests/</code> subfolder which will test functions which are given under <code>sol/</code>. Or manually unittesting your challenge can also be done. You just have to ensure that every bit and piece of the challenge works before pushing it to our registry.</p></li></ul><h2 id=technical-side-of-creating-challenge>Technical side of creating challenge<a href=#technical-side-of-creating-challenge class=anchor aria-hidden=true>#</a></h2><p>Imagine a situation where you are using a framework in your infrastructure which is vulnerable and the exploit has been published on https://www.exploit-db.com. In order to experience what you may face by having that vulnerability, a simulation environment could be set up by using docker containers. Steps could differ challenge to challenge however, most of the steps are same for all kind of challenges. Prerequisites of creating a challenge consists of having knowledge about docker environment and basic programming skills.</p><p>Steps for creating a challenge could be summarized as shown below:</p><ol><li>Define a challenge to create, let&rsquo;s consider the one which is <code>Webmin 1.920 - Unauthenticated Remote Code Execution (Metasploit)</code> (https://www.exploit-db.com/exploits/47230).</li><li>In order to create the given challenge, examine layers (environment ~ operating system, specific version of program and etc ) which could be needed to run vulnerable <code>Webmin</code> on docker container.</li><li>Once all explanation is examined through https://www.exploit-db.com, make a list of them and started to implement on docker file.</li></ol><ul><li><p><em>Linux operating system (could Ubuntu 18.04 ) since there is no specification of the version of operating system which will handle php on it</em></p></li><li><p>The vulnerability itself requires to have perl language on top of operating system therefore it will be the second step to install.</p></li><li><p>Since the mentioned vulnerability requires webmin 1.920 version then, it should be installed it by using install instructions which are already exists on webmin official page. Just install it using source code, in order to have vulnerability in a containerized environment.</p></li><li><p>Afterwards all configuration settings will be based on kind of challenge that you are writing, define bash script which handles all configuration things regarding to webmin, php, perl.</p></li><li><p>In bash script, an environment variable should be declared in order to provide it to Haaukins itself, so the provided environment variable will be used to create dynamic flags. Example:</p><ul><li><code>$APP_FLAG</code> , in Haaukins side, Haaukins will generate unique UUID flag for given environment variable.</li></ul></li></ul><p>Example Dockerfile for a challenge which describes how the vulnerability of <code>webmin 1.920</code> framework can be simulated using dockerfile.</p><p>Before starting to write Dockerfile, you either need to download the package to your local and copy it into container or you can fetch that using <code>curl</code> and download it into container directly. In this example, we are assuming that you have already downloaded the freamwork (webmin 1.920)</p><p><code>Dockerfile</code></p><pre><code>FROM ubuntu:18.04   // this is base layer for our containerized environment...
FROM perl:5.20      // adding additional software on top of base layer in order to run webmin, so this is a prerequisite
COPY webmin-1.920.tar.gz  .  // which is copying tar.gz file into container.

RUN gunzip  webmin-1.920.tar.gz &amp;&amp; \
    tar xf wembin-1.920.tar &amp;&amp; \
    cd webmin-1.920 &amp;&amp; \
    ./setup.sh  /usr/local/webmin    //  setup.sh is default setup script for webmin-1.920, so it is already inside tar.gz

COPY /etc/webmin/config .           // copying configuration files into docker container
COPY /etc/webmin/miniserv.conf .    // copying configuration files into docker container

COPY run.sh .  // this is the bash script where all configuration files has been set with the flag.

RUN chmod +x run.sh  // change permission of the run.sh script

CMD [&quot;./run.sh&quot;]   // starting point of webmin-1.920 framework.

</code></pre><p><code>run.sh</code></p><pre><code>
#!/bin/sh

cp config /etc/webmin
cp miniserv.conf /etc/webmin
echo &quot; $APP_FLAG&quot; &gt;&gt; /var/flag.txt
unset APP_FLAG                # this is crucial to unset, otherwise a user can print all environment variables and can get the flag.
echo Starting webmin
/etc/init.d/webmin start
while :; do echo 'Press &lt;CTRL+C&gt; to exit.'; sleep 1; done  

</code></pre><p>More things to keep in mind, the networking setting should not be overlap, otherwise, the challenge cannot be imported into Haaukins environment properly. Please consider following matters as well, while constructing a challenge in a containerzed environment.</p><p>Generally, challenges can consist of any set of docker images and VirtualBox OVA&rsquo;s. However, these images are constrained by the following</p><ul><li>They will reside on the same /24 subnet, that in unknown to the images prior to boot.`</li><li>Make sure DNS records used for service discovery is fairly unique, to avoid colliding records with other challenges.</li><li>Docker images that are supposed to contain flags should ideally be able to receive a dynamic flag through the APP_FLAG environment variable (or another environment variable specified in the challenge config).</li></ul><p>Note that the given examples differs challenge to challenge, however the concept is same, build vulnerable enviroment in docker (containerized docker environment) and then set flag environment into a file or somewhere, lastly do not forget to unset flag from environment once setting the flag to a file process is done.</p><p>For further assistance, please contact us by creating an issue regarding to creating a challenge, under wiki (this repository).</p><p><em>(Please declare your situation as much detalied as possible, otherwise we may face a deadlock where nobody can benefit from it. )</em></p><h2 id=deploying-a-challenge>Deploying a Challenge<a href=#deploying-a-challenge class=anchor aria-hidden=true>#</a></h2><p>Deploying challenges from gitlab is very easy, you can use the following template and put it into the <code>.gitlab-ci.yml</code> file;</p><pre><code>docker-push-to-gitlab-registery:
  image: docker:latest
  stage: build
  services:
    - docker:dind
  before_script:
    - docker login -u &quot;$CI_USER&quot; -p &quot;$CI_TOKEN&quot; $GITLAB_REGISTERY
  script:
    - docker build --pull -t &quot;$GITLAB_REGISTERY/haaukins/challenge_category/challengerepo&quot; .
    - docker push &quot;$GITLAB_REGISTERY/haaukins/challenge_category/challengerepo&quot;
  only:
    - master
</code></pre><p class=edit-page><a href=https://github.com/aau-network-security/haaukins-docs/blob/master/content/docs/challenges/how-to-create-chal.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class="docs-navigation d-flex justify-content-between"><a href=/docs/challenges/challenge-struct/><div class="card my-1"><div class="card-body py-2">&larr; A Challenge Struct</div></div></a><a class=ml-auto href=/docs/help/troubleshooting/><div class="card my-1"><div class="card-body py-2">Troubleshooting Haaukins &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Haaukins - Open Source Cyber Training Platform</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline><li class=list-inline-item><a href=/privacy-policy/>Privacy</a></li></ul></div></div></div></footer><script src=/main.7aae31ac6f142dfbc02d0f1d58678e78716c88e1a9c5565039568ada8cfed1a0dd9244e0a3bc4504b6e45e0e67b35e3b7d7a8024de06f37cfe3333d7ef220a91.js integrity="sha512-eq4xrG8ULfvALQ8dWGeOeHFsiOGpxVZQOVaK2oz+0aDdkkTgo7xFBLbkXg5ns147fXqAJN4G83z+MzPX7yIKkQ==" crossorigin=anonymous defer></script><script src=/index.min.c4e813c41645762fb5401914f7e898f9bfdbeaf013818cbf222cd6196eb13e55edbda54f844971730d49793fdf93ac74970bd77985dd4cb0b1e8efc51c3df2bd.js integrity="sha512-xOgTxBZFdi+1QBkU9+iY+b/b6vATgYy/IizWGW6xPlXtvaVPhElxcw1JeT/fk6x0lwvXeYXdTLCx6O/FHD3yvQ==" crossorigin=anonymous defer></script></body></html>